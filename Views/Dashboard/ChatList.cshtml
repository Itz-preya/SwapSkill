@model IEnumerable<SkillSwapApp.ViewModels.ChatListItemViewModel>

<h2 style="color:#fff; margin-bottom:12px;">Chats</h2>
<div class="chat-list">
    <div class="chat-search">
        <input id="chatSearchInput" type="text" placeholder="Search chats..." autocomplete="off" />
    </div>
    @if (!Model.Any())
    {
        <div class="chat-empty">No chats yet.</div>
    }
    else
    {
        foreach (var item in Model)
        {
            <a class="chat-item" asp-controller="Chat" asp-action="Chat" asp-route-userId="@item.PartnerId" data-name="@item.PartnerName">
                <div class="chat-avatar">@((item.PartnerName ?? "").FirstOrDefault().ToString().ToUpper())</div>
                <div class="chat-main">
                    <div class="chat-top">
                        <div class="chat-name">@item.PartnerName</div>
                        <div class="chat-time">@(item.LastMessageAt?.ToLocalTime().ToString("hh:mm tt") ?? "")</div>
                    </div>
                    <div class="chat-bottom">
                        <div class="chat-preview">@item.LastMessage</div>
                    </div>
                </div>
            </a>
        }
    }
    
</div>

<script>
    (function(){
        const input = document.getElementById('chatSearchInput');
        if(!input) return;
        input.addEventListener('input', function(){
            const q = input.value.trim().toLowerCase();
            document.querySelectorAll('.chat-list .chat-item').forEach(function(item){
                const name = (item.getAttribute('data-name') || '').toLowerCase();
                item.style.display = name.includes(q) ? '' : 'none';
            });
        });
    })();
    </script>
